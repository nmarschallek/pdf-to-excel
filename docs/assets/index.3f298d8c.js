import{r as e,o as r,c as t,a as s,u as n,i as a,b as o,p as l,X as i,d as c}from"./vendor.fc9d94ba.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&r(e)})).observe(document,{childList:!0,subtree:!0})}function r(e){if(e.ep)return;e.ep=!0;const r=function(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerpolicy&&(r.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?r.credentials="include":"anonymous"===e.crossorigin?r.credentials="omit":r.credentials="same-origin",r}(e);fetch(e.href,r)}}();const u={class:"flex w-full h-screen items-center justify-center text-center",id:"app"},d=s("label",{for:"assetsFieldHandle",class:"block cursor-pointer"},[s("div",null,[o(" You can drop files in here or "),s("span",{class:"underline"},"click here"),o(" to upload your files ")])],-1);c({setup(o){let c=e(null),p=()=>{y(c.value.files[0]),c.value=null},f=e=>{e.preventDefault(),e.currentTarget.classList.contains("bg-green-300")||(e.currentTarget.classList.remove("bg-gray-100"),e.currentTarget.classList.add("bg-green-300"))},g=e=>{e.currentTarget.classList.add("bg-gray-100"),e.currentTarget.classList.remove("bg-green-300")},m=e=>{e.preventDefault(),y(e.dataTransfer.files[0]),e.currentTarget.classList.add("bg-gray-100"),e.currentTarget.classList.remove("bg-green-300")},y=e=>{l.exports.GlobalWorkerOptions.workerSrc="//cdn.jsdelivr.net/npm/pdfjs-dist@2.9.359/build/pdf.worker.min.js";const r=new FileReader;r.readAsDataURL(e),r.addEventListener("load",(()=>{l.exports.getDocument(r.result).promise.then((async function(r){function t(e){return e&&Array.isArray(e.transform)&&e.transform[4]||-1}const s=await(async(e,r={})=>{const{onProgress:s,start:n,end:a}=r,o=[];let l=1,i=0;for("number"==typeof n&&"number"==typeof a&&n<a&&(l=n,i=a),"number"==typeof e.numPages&&0===i&&(i=e.numPages);l<=i;){"function"==typeof s&&s({numPage:l,numPages:i});const r=await e.getPage(l),n=await r.getTextContent();if(Array.isArray(n.items)){const{items:e}=n,r=t(e[0]);let s=[];for(let n=0;n<e.length;n+=1){t(e[n])<=r&&(o.push(s),s=[]),s.push(e[n])}s.length&&o.push(s)}l+=1}return o})(r),[n=[],...a]=s,o=n.map((e=>e.str)),l=i.utils.aoa_to_sheet(a.map((e=>e.map((e=>e.str)))),o),c=i.utils.book_new();i.utils.book_append_sheet(c,l,"Sheet1"),i.writeFile(c,e.name.replace(".pdf",".xlsx"))}))}),!1)};return(e,o)=>(r(),t("div",u,[s("div",{class:"p-12 bg-gray-100 border border-gray-300",onDragover:o[1]||(o[1]=(...e)=>n(f)&&n(f)(...e)),onDragleave:o[2]||(o[2]=(...e)=>n(g)&&n(g)(...e)),onDrop:o[3]||(o[3]=(...e)=>n(m)&&n(m)(...e))},[s("input",{type:"file",name:"fields[assetsFieldHandle][]",id:"assetsFieldHandle",class:"w-px h-px opacity-0 overflow-hidden absolute",onChange:o[0]||(o[0]=(...e)=>n(p)&&n(p)(...e)),ref:(e,r)=>{r.file=e,a(c)?c.value=e:c=e},accept:".pdf"},null,544),d],32)]))}}).mount("#app");
